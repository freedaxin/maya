all: clean tokenizer
	node-gyp configure build
	cp -rf build/Release/sqlparser.node lib/

tokenizer:
	flex sql-tokenizer.l
	mv -f lex.yy.c sql-tokenizer.c
	gcc -c  -fPIC -DPIC -O3  sql-tokenizer.c -lglib-2.0 -I.  -I/usr/include/glib-2.0 -I/usr/lib64/glib-2.0/include
	ar -q sql-tokenizer.a sql-tokenizer.o
	cp sql-tokenizer.a ./lib
clean:
	node-gyp clean
	rm -rf *.o *.a

test: all
	./node_modules/expresso/bin/expresso

